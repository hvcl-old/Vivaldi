def function(data, x, y):
	left = point_query_2d(data, x-1, y)
	right = point_query_2d(data, x+1, y)
	val = left and right
	return val

def main():
	import numpy as np
	data = np.ones((10,10), dtype=numpy.float32)

	result = function(data, x, y).range(x=0:10,y=0:10)
								 .dtype(data,float)
								 .split(data, x=2)
								 .split(result, x=2)
								 .halo(data,1)

	correct = np.ones((10,10))
	correct[0] = 0
	correct[-1] = 0
	correct = correct.transpose()

	if (correct == result).all():
		print "OK"
	else:
		print "Fail"
		print "Correct"
		print correct
		print "Result"
		print result
